$(function(){load_form();chart_label_check();$("input, textarea, select").change(save_form);$("input, textarea, select").keyup(save_form);$(".toggle-checkbox").click(toggle_checkbox);$("#chart input").bind("keyup change",elextern_chart);$("#chart #legend span").click(save_form);$("#table-wrap input").bind("keyup change",ajax_table);$(".energy-item").click(toggle_energy_item);reinitialize();initialize_touchspin();mode_initialize()});function reinitialize(){$('* [data-placement="bottom"], * [data-placement="left"], * [data-placement="right"], * [data-placement="top"]').popover({trigger:"hover"})}function ajax_table(){ajax_implicit_price();$.ajax({type:"POST",url:"ajax.php?action=table",data:$("#elextern-form").serialize(),success:function(a,c,b){$("#table-content").html(a);reinitialize()}})}function ajax_implicit_price(){if($("#ajax-implicit-co2-price").length==0){return false}$.ajax({type:"POST",url:"ajax.php?action=implicit_price",data:$("#elextern-form").serialize(),success:function(b,d,c){var a=$.parseJSON(b);$("#ajax-implicit-co2-price").html(a.implicit_co2_price);$("#ajax-implicit-land-price").html(a.implicit_land_price);$("#ajax-implicit-nuclear-fuel-price").html(a.implicit_nuclear_fuel_price);$("#ajax-implicit-nuclear-waste-price").html(a.implicit_nuclear_waste_price)}});return true}function toggle_checkbox(){var b=$(this).data("checkbox");var a=$(b);a.trigger("click");if(a.attr("checked")){a.removeAttr("checked")}else{a.attr("checked",true)}$(this).toggleClass("disabled-legend");$(this).find(".fa").toggleClass("fa-eye-slash");$(this).find(".fa").toggleClass("fa-eye")}function save_form(){var a={text:{},select:{},checkbox:{}};$(".elextern-storage").each(function(){var b=get_storage_type($(this));switch(b){case"text":var c=$(this).val();break;case"checkbox":if($(this).attr("checked")){var c="checked"}else{var c="unchecked"}break;case"select":var c=$(this).find(":selected").val();break}a[b][$(this).attr("id")]=c});localStorage.setItem("elextern",JSON.stringify(a))}function get_storage_type(a){if(a.attr("type")=="text"||a.attr("type")=="number"){return"text"}if(a.is("textarea")){return"text"}if(a.is("select")){return"select"}if(a.attr("type")=="checkbox"){return"checkbox"}}function load_form(){if(localStorage.elextern==null){return false}var a=JSON.parse(localStorage.elextern);$.each(a,function(c,b){switch(c){case"text":load_form_text(b);break;case"checkbox":load_form_checkbox(b);break;case"select":load_form_text(b);break}})}function load_form_text(a){$.each(a,function(c,b){$("#"+c).val(b)})}function load_form_checkbox(a){$.each(a,function(c,b){if(b=="checked"){$("#"+c).attr("checked",true)}else{$("#"+c).removeAttr("checked")}})}function form_default_value(){$(".elextern-storage").each(function(){if($(this).attr("type")=="text"){$(this).val($(this).data("default"))}});$("#elextern-form input:first").trigger("change")}function chart_label_check(){$(".toggle-checkbox").each(function(){var b=$(this).data("checkbox");var a=$(b);if(a.attr("checked")==null){$(this).toggleClass("disabled-legend");$(this).find(".fa").toggleClass("fa-eye-slash");$(this).find(".fa").toggleClass("fa-eye")}})}function toggle_energy_item(){var a=$(this).data("energy");$(this).toggleClass("btn-success");$(this).toggleClass("btn-danger");var b=getCookie(a);if(b=="disabled"){setCookie(a,"enabled","/",20)}else{setCookie(a,"disabled","/",20)}if($("#table").length>0){setTimeout(ajax_table,250)}if($("#chart").length>0){setTimeout(elextern_chart,250)}}function set_advanced_cookie(a){form_default_value();setCookie("advanced",a,"/",20);window.location=window.location.href}function mode_initialize(){var a=$("#mode").val();if(a=="basic"){$(".advanced-only").hide()}else{$(".basic-only").hide()}};